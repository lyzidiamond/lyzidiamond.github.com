{{/*
Shortcode: optimg
Usage: {{< optimg src="lyzi.jpg" width="300" alt="Lyzi" >}}
Looks for the image under assets/images and outputs a resized version using Hugo image processing.
*/}}
{{ $src := .Get "src" | default "" }}
{{ if eq $src "" }}
  {{ errorf "optimg shortcode: missing 'src' parameter" }}
{{ end }}
{{ $width := .Get "width" | default "800" }}

{{ $img := resources.Get (printf "images/%s" $src) }}
{{ if not $img }}
  {{ errorf "optimg shortcode: image '%s' not found in assets/images" $src }}
{{ end }}

{{/* Use Resize by width (e.g. 300 -> "300x") so aspect ratio is preserved */}}
{{ $resized := $img.Resize (printf "%sx" $width) }}

<img src="{{ $resized.Permalink }}" width="{{ $resized.Width }}" height="{{ $resized.Height }}" alt="{{ .Get "alt" | default "" }}" loading="lazy" decoding="async">
